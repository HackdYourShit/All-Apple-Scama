/* IMPORTANT NOTE: This file is licensed only for use in providing the iCloud service,
*   or any part thereof, and is subject to the iCloud Terms and Conditions. You may not
*   port this file to another platform without Apple's written consent. */

SC.MODULE_INFO['cloudkit/error_catcher'].source = "SC.stringsFor(\"fr-fr\",{\"ErrorCatcher.Dialog.Caption\":'En cliquant sur « Envoyer à Apple », vous autorisez Apple à collecter ces informations et à les utiliser dans le cadre de ses services d’assistance, et pour améliorer ses produits et services. Ce rapport inclut des données personnelles telles que votre nom d’abonné et vos données d’utilisateur. Pour obtenir de plus amples informations sur l’Engagement de confidentialité d’Apple, consultez la page <a target=\"_BLANK\" href=\"http://www.apple.com/fr/privacy/\">http://www.apple.com/fr/privacy/</a>.',\"ErrorCatcher.Dialog.CloseButton\":\"Fermer\",\"ErrorCatcher.Dialog.Details\":\"Détails\",\"ErrorCatcher.Dialog.ReloadButton\":\"Recharger\",\"ErrorCatcher.Dialog.ReportButton\":\"Envoyer à Apple\",\"ErrorCatcher.Dialog.Text\":\"Une erreur a empêché cette application de fonctionner correctement. Vous pouvez aider Apple à améliorer ses produits en nous envoyant des informations de diagnostic et d’utilisation concernant iCloud.\",\"ErrorCatcher.Dialog.Title\":\"%@ a arrêté de répondre.\",\"ErrorCatcher.Dialog.Title.NoApp\":\"L’application s’est interrompue inopinément.\"}),CK.errorCatcher.mixin({MAX_RECENT_LOG_MESSAGES_SIZE:48e3,initMixin:function(){this._radarComponents=SC.merge(this._radarComponents,{contacts:{name:\"iCloud Contacts Web App\",version:\"All\"},mail:{name:\"iCloud Mail Web Client\",version:\"All\"},find:{name:\"iCloud FMiP Web\",version:\"1.0\"},calendar:{name:\"iCloud Calendar Web App\",version:\"All\"},cloudos:{name:\"iCloud CloudOS\",version:\"All\"},notes:{name:\"iCloud Notes Web App\",version:\"All\"},photos:{name:\"iCloud Photos Web App\",version:\"All\"},reminders:{\nname:\"iCloud Reminders Web App\",version:\"All\"},iclouddrive:{name:\"iCloud Drive Web App\",version:\"All\"},settings:{name:\"iCloud Settings Web App\",version:\"All\"}})},moduleDidLoad:function(e,t){this.customize&&this.customize();var n=t.applicationName||\"cloudos\",r=SC.clone(t,YES),i;r.type=t.type,r=this._fieldsForHash(r,n),this.displayExceptionDialog(r,n,t)},displayExceptionDialog:function(e,t,n){var r=(\"AppTitle.\"+t).loc(),i=\"ErrorCatcher.Dialog.Text\".loc(),s=\"ErrorCatcher.Dialog.Caption\".loc(),o=e.type,u=e.text,a,f;e.errorTitle?f=e.errorTitle:r&&!CK.currentApplication?f=\"ErrorCatcher.Dialog.Title\".loc(r):f=\"ErrorCatcher.Dialog.Title.NoApp\".loc(),o!==\"exception\"&&(f=n.title?n.title:f,i=n.message?n.message:i);var l=this;this._alert=CW.Alert.show({message:f,description:i,escapeHTML:YES,layout:{centerX:0,width:500,centerY:0,minHeight:160},image:\"icon-icloud error\",leftButton:function(){var e=function(){for(var e=0;e<navigator.mimeTypes.length;e++){var t=navigator.mimeTypes[e];if(t.suffixes===\"x-snkp\"&&t.enabledPlugin)return!0}return!1}();if(!e||!SC.browser.isSafari)return;return{title:\"Create Radar\",action:\"createRadar\"}}(),rightButton:{title:\"ErrorCatcher.Dialog.ReportButton\".loc(),action:\"report\"},middleButton:{title:n.isFatal&&CK.errorCatcher.shouldReloadIfFatal?\"ErrorCatcher.Dialog.ReloadButton\".loc():\"ErrorCatcher.Dialog.CloseButton\".loc(),action:\"close\"},close:function(){l.exitErrorCatcher(n,t),this.remove()},report:function(){l.sendErrorReport(e,t,n),this.remove()},createRadar:function(){var n=l._radarComponents[t],r=window.escape(n?n.name:\"iCloud Web\"),i=window.escape(n?n.version\n:\"All\"),s=window.escape(e.error||\"\"),o=window.escape(\"* SUMMARY\\nRecap the problem title and/or include more descriptive summary information.\\n\\n* ERROR CATCHER LOG\\n\\n\"+u),a=\"rdar://new/problem/component=%@&version=%@&title=%@&description=%@\".fmt(r,i,s,o);window.location=a},extraViewPadding:{top:15,bottom:8},extraView:CW.DetailsDisclosureView.design({caption:s,disclosureTitle:\"ErrorCatcher.Dialog.Details\".loc(),contentView:SC.TextFieldView.design({layout:{height:90},isTextArea:YES,isVisible:NO,value:u,isEditable:NO,render:function(e){e.setClass(\"text-area\",YES),e.push('<div class=\"border\"></div>'),e.push('<div class=\"padding\"><textarea readonly class=\"field\">'+this.get(\"value\")+\"</textarea></div>\")}})})}),CloudOS.recordStat(\"ErrorCatcherWasDisplayed\",{error:\"Error Catcher was displayed\",errorAppName:t,type:n.type,isFatal:n.isFatal})},exitErrorCatcher:function(e,t){e.isFatal&&(CK.errorCatcher.shouldReloadIfFatal&&CK.reloadWithReason(\"exitErrorCatcher\"),CloudOS.isCloudOSClient?CloudOS.appController.exitApplication(t,CK.EXIT_NON_FATAL):CK.currentApplication&&CK.currentApplication.isWindowApplication&&window.close()),e.dismissCallback&&e.dismissCallback.call(),CK.errorCatcher.set(\"isReporting\",NO)},sendErrorReport:function(e,t,n){var r=e.error||e.type,i=this,s,o,u,a;e.text=null,u={appName:t,errorTitle:r,errorType:n.type};for(s in e)o=e[s],o!==undefined&&o!==null&&(u[s]=o);a=CW.Request.postUrl(\"/reportError\"),a.set(\"addressPrefix\",\"https://feedbackws.icloud.com\"),a.set(\"useCrossDomain\",YES),a.set(\"isJSON\",YES),a.set(\"attachIdentifyingHeaders\",NO),a.header(\"Content-Type\",\"text/plain\"\n),a.notify(200,this,function(e){return i.exitErrorCatcher(n,t),YES}),a.notify(0,this,function(e){return i.exitErrorCatcher(n,t),YES}),SC.debug(\"CloudKit: Sending error catcher report for “%@”\",t),a.send(u)},_fieldsForHash:function(e,t){e||(e={});var n,r,i;e.buildNumber=SC.buildNumber,e.time=(new Date).toString()+\"        (\"+Math.floor(new Date)+\")\",e.host=window.location.host,e.userAgent=navigator.userAgent+\"\",n=CloudOS.isCloudOSClient?CloudOS.authController&&CloudOS.authController.get(\"user\"):CloudOS.getUser(),n&&n.get&&(r=n.get(\"dsid\"),e.dsid=n.get(\"dsid\")),e.environment=function(){return CloudOS.isCloudOSClient?COS.authController.get(\"environment\"):CloudOS.getEnvironment()}(),e.recentLogMessages=function(){return String(e.log||SC.Logger.stringifyRecordedLogMessages()||\"\")}().substr(-this.MAX_RECENT_LOG_MESSAGES_SIZE);var s=[],o,u,a,f,l,c,h,p;for(o in e){u=e[o];if(!u)continue;a=\"\",c=YES;for(f=0,l=o.length;f<l;++f)h=o.charAt(f),p=h.toUpperCase(),h===p&&(f===0&&(c=NO),c&&(a+=\" \")),a+=p;s.push(a),s.push(u+\"\\n\")}return e.text=s.join(\"\\n\"),e}});";